{"version":3,"sources":["../../src/portal.tsx"],"names":["createContext","isBrowser","__DEV__","React","ReactDOM","usePortalManager","useSafeLayoutEffect","PortalContextProvider","usePortalContext","strict","name","Portal","props","onMount","onUnmount","children","getContainer","portal","useState","div","document","createElement","className","parentPortal","manager","append","useCallback","container","appendChild","customContainer","node","body","contains","removeChild","_children","zIndex","position","width","createPortal","displayName"],"mappings":"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","sourcesContent":["import { createContext, isBrowser, __DEV__ } from \"@chakra-ui/utils\"\nimport * as React from \"react\"\nimport * as ReactDOM from \"react-dom\"\nimport { usePortalManager } from \"./portal-manager\"\nimport { useSafeLayoutEffect } from \"@chakra-ui/hooks\"\n\ntype PortalContext = HTMLDivElement | null\n\nconst [PortalContextProvider, usePortalContext] = createContext<PortalContext>({\n  strict: false,\n  name: \"PortalContext\",\n})\n\nexport interface PortalProps {\n  /**\n   * Function called when the portal mounts\n   */\n  onMount?(): void\n  /**\n   * Function called when the portal unmounts\n   */\n  onUnmount?(): void\n  /**\n   * Function that will be called to get the parent element\n   * that the portal will be attached to.\n   */\n  getContainer?: () => HTMLElement | null\n  /**\n   * The content or node you'll like to portal\n   */\n  children?: React.ReactNode\n}\n\n/**\n * Portal\n *\n * Declarative component used to render children into a DOM node\n * that exists outside the DOM hierarchy of the parent component.\n *\n * @see Docs https://chakra-ui.com/components/portal\n */\nexport const Portal: React.FC<PortalProps> = (props) => {\n  const { onMount, onUnmount, children, getContainer } = props\n\n  /**\n   * Generate the portal's dom node. We'll wrap the children\n   * in this dom node before mounting it.\n   */\n  const [portal] = React.useState(() => {\n    if (isBrowser) {\n      const div = document.createElement(\"div\")\n      div.className = \"chakra-portal\"\n      return div\n    }\n    // for ssr\n    return null\n  })\n\n  /**\n   * This portal might be nested in another portal.\n   * Let's read from the portal context to check this.\n   */\n  const parentPortal = usePortalContext()\n\n  /**\n   * If there's a PortalManager rendered, let's read from it.\n   * We use the portal manager to manage multiple portals\n   */\n  const manager = usePortalManager()\n\n  const append = React.useCallback(\n    (container: HTMLElement | null) => {\n      // if user specified a mount node, do nothing.\n      if (!portal || !container) return\n\n      // else, simply append component to the portal node\n      container.appendChild(portal)\n    },\n    [portal],\n  )\n\n  useSafeLayoutEffect(() => {\n    // get the custom container from the container prop\n    const customContainer = getContainer?.()\n\n    /**\n     * We need to know where to mount this portal, we have 4 options:\n     * - If a mountRef is specified, we'll use that as the container\n     * - If portal is nested, use the parent portal node as container.\n     * - If it's not nested, use the manager's node as container\n     * - else use document.body as containers\n     */\n    const container =\n      customContainer ?? parentPortal ?? manager?.node ?? document.body\n\n    /**\n     * Append portal node to the computed container\n     */\n    append(container)\n\n    onMount?.()\n\n    return () => {\n      onUnmount?.()\n\n      if (!portal) return\n\n      if (container?.contains(portal)) {\n        container?.removeChild(portal)\n      }\n    }\n  }, [\n    getContainer,\n    portal,\n    parentPortal,\n    onMount,\n    onUnmount,\n    manager?.node,\n    append,\n  ])\n\n  const _children = manager?.zIndex ? (\n    <div\n      className=\"chakra-portal-zIndex\"\n      style={{\n        position: \"absolute\",\n        zIndex: manager.zIndex,\n        width: \"100%\",\n      }}\n    >\n      {children}\n    </div>\n  ) : (\n    children\n  )\n\n  if (!portal) {\n    return <React.Fragment>{_children}</React.Fragment>\n  }\n\n  return ReactDOM.createPortal(\n    <PortalContextProvider value={portal}>{_children}</PortalContextProvider>,\n    portal,\n  )\n}\n\nif (__DEV__) {\n  Portal.displayName = \"Portal\"\n}\n"],"file":"portal.js"}